<!DOCTYPE html>
<html lang="en" data-theme="system">
<head>
  <meta charset="utf-8" />
  <title>mrpack upgrader for Modrinth</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Floating theme switcher -->
  <div class="theme-switch" role="group" aria-label="Theme switcher">
    <button id="theme-system" class="theme-btn" title="System (follow OS)" aria-label="System theme">üñ•Ô∏è</button>
    <button id="theme-light" class="theme-btn" title="Light" aria-label="Light theme">‚òÄÔ∏è</button>
    <button id="theme-dark" class="theme-btn" title="Dark" aria-label="Dark theme">üåô</button>
            <button id="missing-items-btn" class="theme-btn" title="Missing Items Tracker">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
    <button id="help-btn" class="theme-btn" title="Help" aria-label="Help">‚ùì</button>
  </div>

  <h1>Modrinth mrpack ‚Üí version availability</h1>

  <div class="controls">
    <div>
      <label for="file">mrpack file:&nbsp;</label>
      <div class="file-input-wrapper">
        <input type="file" id="file" accept=".mrpack" />
        <label for="file" class="file-input-label">Choose file</label>
        <span id="file-name" class="file-name"></span>
      </div>
    </div>
    
    <div class="control-row">
      <label for="mc">Target MC:&nbsp;</label>
      <select id="mc" disabled><option>Loading‚Ä¶</option></select>
      <label for="loader">Loader:&nbsp;</label>
      <select id="loader">
        <option value="fabric" selected>fabric</option>
        <option value="quilt">quilt</option>
        <option value="forge">forge</option>
        <option value="neoforge">neoforge</option>
      </select>
      <button id="run">Check</button>
    </div>
    
    <div class="control-row" id="build-controls" style="display:none;">
      <button id="build" disabled>Build updated .mrpack</button>
      <button id="capture-missing" disabled style="display:none;">Remember missing items</button>
      <a id="downloadLink" class="small" style="display:none;">Download ready</a>
      <span id="buildNote" class="small muted"></span>
    </div>
  </div>

  <div style="margin-top:1rem;">
    <div id="summary" class="counts muted"></div>
    <div class="bar"><span id="bar"></span></div>
    <div class="status">
      <strong id="phase">Idle</strong>
      <small id="detail"></small>
    </div>
  </div>

  <div id="results" style="margin-top:1rem;">
    <h2>Mods</h2>
    <div id="mods-table"></div>

    <h2>Resource Packs</h2>
    <div id="res-table"></div>

    <h2>Shaders</h2>
    <div id="shader-table"></div>
  </div>

  <details style="margin-top:1rem;">
    <summary>Raw results (debug)</summary>
    <pre id="raw"></pre>
  </details>

  <!-- Help Modal -->
  <div id="help-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>How to use mrpack upgrader</h2>
        <button id="help-close" class="modal-close" aria-label="Close help">&times;</button>
      </div>
      <div class="modal-body">
        <h3>üîí Privacy & Security</h3>
        <p><strong>Your files never leave your browser!</strong> All processing happens locally on your device. No uploads to servers, no data collection.</p>
        <p><strong>API Usage:</strong> The tool queries Modrinth's public API to check mod compatibility. Only minimal data is sent: file hashes (SHA1) to identify mods and version queries. No personal information or modpack contents are transmitted.</p>
        
        <h3>üìã How it works</h3>
        <ol>
          <li><strong>Upload</strong> your .mrpack file</li>
          <li><strong>Select</strong> target Minecraft version and modloader</li>
          <li><strong>Click "Check"</strong> to analyze mod compatibility</li>
          <li><strong>Review</strong> which mods have updates available</li>
          <li><strong>Download</strong> an updated .mrpack with compatible versions</li>
          <li><strong>Remember missing items</strong> to track unavailable mods for future updates</li>
        </ol>
        
        <h3>‚úÖ What it does</h3>
        <ul>
          <li>Checks Modrinth for compatible mod versions</li>
          <li>Shows availability for your target Minecraft version</li>
          <li>Handles mods, resource packs, and shader packs</li>
          <li>Falls back to GitHub for Fabric Carpet mod</li>
          <li>Preserves all other files in your modpack (configs, overrides, etc.)</li>
          <li>Generates updated modpacks you can download</li>
        </ul>
        
        <h3>‚ùå Missing Items Tracker</h3>
        <ul>
          <li>Click the red <strong>‚ùå</strong> button to track mods that aren't available for your target MC version</li>
          <li>Use "Remember missing items" after checking to save unavailable mods for future reference</li>
          <li>The tracker automatically checks for updates and notifies you when mods become available</li>
          <li>Helpful for keeping tabs on when your favorite mods get updated</li>
        </ul>
        
        <h3>‚ö†Ô∏è Limitations</h3>
        <ul>
          <li>Only works with Modrinth .mrpack files</li>
          <li>Primarily tested with Fabric modpacks (other loaders may work but are less tested)</li>
          <li>Doesn't resolve mod dependencies automatically</li>
          <li>Some mods may not be available for all MC versions</li>
        </ul>
        
        <p style="margin-top: 2rem; text-align: center; color: var(--muted); font-style: italic;">
          Hope you enjoy!<br>
          Kris
        </p>
      </div>
    </div>
  </div>

  <!-- Missing Items Panel -->
  <div id="missing-items-panel" class="modal" style="display:none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Missing Items Tracker</h2>
        <button id="missing-items-close" class="modal-close" aria-label="Close missing items panel">&times;</button>
      </div>
      <div class="modal-body">
        <div id="missing-items-list" class="missing-items-list">
          <p class="muted">No missing items tracked yet. Use "Remember missing items" when building modpacks to track unavailable mods.</p>
        </div>
        <div class="missing-items-controls">
          <button id="check-missing-items" class="missing-check-btn">üîç Check for Updates</button>
          <button id="clear-missing-items" class="missing-clear-btn">üóëÔ∏è Clear All</button>
          <span id="missing-items-status" class="missing-status"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Notification Toast -->
  <div id="notification-toast" class="notification-toast" style="display:none;">
    <div class="notification-content">
      <span id="notification-text"></span>
      <button id="notification-close" class="notification-close">&times;</button>
    </div>
  </div>
  
  <script src="./jszip-dist/jszip.min.js"></script>
  <script src="script.js"></script>
</body>
</html>